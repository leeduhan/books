

# 프로그램이 새로운 기능을 추가 하기에 편한 구조가 아니라면, 먼저 기능을 추가 하기 쉬운 형태로 리팩터링 하고 나서 원하는 기능을 추가 한다.

- 오래 사용할 프로그램 이라면 중복 코드는 골칫거리가 된다. 
- 정책이 복잡 해질수록 수정할 부분을 찾기 어려워지고 수정 과정에서 실수할 가능성이 커진다. 
- 리펙토링이 필요한 이유는 바로 이런 정책의 변경 때문이다. 나중에 변경될 일이 전혀 없다면 현재 상태를 놔둬도 문제가 되지 않는다. 그러다 다른 사람이 읽고 이해 해야할 일이 생겼는데 로직을 파악 하기 어렵다면 뭔가 대책을 세워야 한다. 

# 리팩터링 첫단계

## 리팩터링하기 전에 제대로된 테스트 부터 마련한다. 테스트는 반드시 자가 진단 하도록 만든다 

테스트 프로그램을 이용해서 모든 테스트를 단축키 하나로 실행하게 설정해 둔다. 테스트 결과는 정답 과 같다면 통과인 초록색으로 표시하고 실패 하면 빨간색으로 표시 한다. 즉 성공 / 실패를 스스로 판단하는 자가 진단 테스트를 만들어야 한다. 이를 통해 실수의 가능성을 크게 줄일수 있다.

## 함수 추출하기 

함수를 리팩터링 할때는 전체 동작을 각각의 부분으로 나눌수 있는 지점을 찾는다. 즉 동작을 쪼갠다.

동작을 쪼갠 코드 조각은 별도 함수로 분리 하고 그 코드가 하는일을 설명하는 이름을 지어 준다.

함수를 분리 했을때 유효범위를 벗어나는 변수, 즉 새함수에서 곧바로 사용할수 없는 변수가 있는지 확인한다. 이런 변수는 매개 변수로 전달 한다.

함수 안에서 값이 변경되는 변수는 함수 내부에서 변환 이후 리턴하게 작성한다.

## 리팩터링은 프로그램 수정을 작은 단계로 나눠 진행한다. 그래서 중간에 실수하더라도 버그를 쉽게 찾을수 있다.

한가지를 수정 할때마다 테스트하면 오류가 생기더라도 변경의 폭이 작기 때문에 문제를 찾고 해결하기가 훨씬 쉽다. 조금씩 변경하고 매번 테스트 하는것이 리팩토링 절차의 핵심이다. 한번에 수정하면 디버깅 하기 어려워 결과적으로 작업 시간이 늘어난다.